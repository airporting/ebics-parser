import { describe, expect, test } from 'vitest';

import { getAmount } from './';

const cases = [
  ['0000006564827I', '656482.79', 2],
  ['0000000008653O', '-865.36', 2],
  ['0000003445691I', '344569.19', 2],
  ['0001234{', '123.4', 2],
  ['0000004843H', '484.38', 2],
  ['000000920}', '-92', 2],
  ['000117O', '-1.176', 3], // 3 decs
  ['0000000000000{', '0', 2], // -0 provided by ebics
  ['0000000000000}', '0', 2],
  ['0000000000000}', '0', 3], // 3 decs
  ['0000000000000R', '-0.09', 2],
  // same cases but nbDec is string this time
  ['0000006564827I', '656482.79', '2'],
  ['0000000008653O', '-865.36', '2'],
  ['0000003445691I', '344569.19', '2'],
  ['0001234{', '123.4', '2'],
  ['0000004843H', '484.38', '2'],
  ['000000920}', '-92', '2'],
  ['000117O', '-1.176', '3'],
  ['0000000000000{', '0', '2'],
  ['0000000000000}', '0', '2'],
  ['0000000000000}', '0', '3'],
  ['0000000000000R', '-0.09', '2'],
];

describe('ebics amount parser', () => {
  test.each(cases)('case %s to %s (%s decimals)', (text, expected, nbDec) => {
    expect(getAmount(text as string, nbDec)).toEqual(expected);
  });
});
