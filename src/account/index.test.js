describe('ebics parser', function () {
  let parse;

  beforeEach(() => {
    parse = require('./index');
  });

  test('Sycomore - no transactions', () => {
    const text = [
      `0130004    00071EUR2 00010139479  280323                                                  0000003445691I`,
      `0730004    00071EUR2 00010139479  290323                                                  0000003445691I`,
    ];

    expect(parse(text)).toEqual({
      header: {
        record_code: '01',
        bank_code: '30004',
        desk_code: '00071',
        currency_code: 'EUR',
        nb_of_dec: '2',
        account_nb: '00010139479',
        prev_date: '2023-03-28',
        prev_amount: '344569.19',
      },
      footer: {
        record_code: '07',
        bank_code: '30004',
        desk_code: '00071',
        currency_code: 'EUR',
        nb_of_dec: '2',
        account_nb: '00010139479',
        next_date: '2023-03-29',
        next_amount: '344569.19',
      },
      transactions: [],
      problems: null,
    });
  });

  test('Sycomore 2 - no transactions', () => {
    const text = [
      `0130004    00823EUR2 00010738652  280323                                                  0000000008653O`,
      `0730004    00823EUR2 00010738652  290323                                                  0000000008653O`,
    ];

    expect(parse(text)).toEqual({
      header: {
        record_code: '01',
        bank_code: '30004',
        desk_code: '00823',
        currency_code: 'EUR',
        nb_of_dec: '2',
        account_nb: '00010738652',
        prev_date: '2023-03-28',
        prev_amount: '-865.36',
      },
      footer: {
        record_code: '07',
        bank_code: '30004',
        desk_code: '00823',
        currency_code: 'EUR',
        nb_of_dec: '2',
        account_nb: '00010738652',
        next_date: '2023-03-29',
        next_amount: '-865.36',
      },
      transactions: [],
      problems: null,
    });
  });

  test('Somewhere unknown example - no transactions', () => {
    const text = [
      `0130056    00917EUR2 09170295947  060921                                                  0000000008474P`,
      `0730056    00917EUR2 09170295947  070921                                                  0000000008474P                `,
    ];

    expect(parse(text)).toEqual({
      header: {
        record_code: '01',
        bank_code: '30056',
        desk_code: '00917',
        currency_code: 'EUR',
        nb_of_dec: '2',
        account_nb: '09170295947',
        prev_date: '2021-09-06',
        prev_amount: '-847.47',
      },
      footer: {
        record_code: '07',
        bank_code: '30056',
        desk_code: '00917',
        currency_code: 'EUR',
        nb_of_dec: '2',
        account_nb: '09170295947',
        next_date: '2021-09-07',
        next_amount: '-847.47',
      },
      transactions: [],
      problems: null,
    });
  });

  test('Sycomore 3', () => {
    const text = [
      `0130004    00585EUR2 00010156142  280323                                                  0000006564827I`,
      `0430004056800585EUR2 0001015614218290323  290323DOMUSVI                          0000000  0000000359190{`,
      `0530004056800585EUR2 0001015614218290323     NPYDOMUSVI`,
      `0530004056800585EUR2 0001015614218290323     LCC/INV/3867 8.2.2023`,
      `0530004056800585EUR2 0001015614218290323     RCNNOTPROVIDED`,
      `0530004056800585EUR2 0001015614218290323     PDOFR FRANCE`,
      `0430004081800585EUR2 00010156142B2290323  290323PRLV SEPA/DGFIP IMPOT                   0 0000000560630}FR46ZZZ005002`,
      `0530004081800585EUR2 00010156142B2290323     NBEDGFIP IMPOT`,
      `0530004081800585EUR2 00010156142B2290323     IBEFR46ZZZ005002`,
      `0530004081800585EUR2 00010156142B2290323     RUMNN804148211DGFIP2019921505K41FN7QQ`,
      `0530004081800585EUR2 00010156142B2290323     RCN220750510700113748308`,
      `0530004081800585EUR2 00010156142B2290323     LCCTVA-032023-3310CA3`,
      `0730004    00585EUR2 00010156142  290323                                                  0000006363387I`,
    ];

    expect(parse(text)).toEqual({
      header: {
        record_code: '01',
        bank_code: '30004',
        desk_code: '00585',
        currency_code: 'EUR',
        nb_of_dec: '2',
        account_nb: '00010156142',
        prev_date: '2023-03-28',
        prev_amount: '656482.79',
      },
      footer: {
        record_code: '07',
        bank_code: '30004',
        desk_code: '00585',
        currency_code: 'EUR',
        nb_of_dec: '2',
        account_nb: '00010156142',
        next_date: '2023-03-29',
        next_amount: '636338.79',
      },
      transactions: [
        {
          record_code: '04',
          bank_code: '30004',
          internal_code: '0568',
          desk_code: '00585',
          currency_code: 'EUR',
          nb_of_dec: '2',
          account_nb: '00010156142',
          operation_code: '18',
          operation_date: '2023-03-29',
          reject_code: '',
          value_date: '2023-03-29',
          label: 'DOMUSVI',
          reference: '0000000',
          exempt_code: '',
          amount: '35919',
          debtor_name: 'DOMUSVI',
          remittance_information_1: '/INV/3867 8.2.2023',
          end2end_identification: 'NOTPROVIDED',
          purpose: '',
          PDO: 'FR FRANCE',
          _1: '',
          _2: '',
          _3: '',
          '_4:': '',
        },
        {
          record_code: '04',
          bank_code: '30004',
          internal_code: '0818',
          desk_code: '00585',
          currency_code: 'EUR',
          nb_of_dec: '2',
          account_nb: '00010156142',
          operation_code: 'B2',
          operation_date: '2023-03-29',
          reject_code: '',
          value_date: '2023-03-29',
          label: 'PRLV SEPA/DGFIP IMPOT',
          reference: '',
          exempt_code: '0',
          amount: '-56063',
          _1: '',
          _2: '',
          _3: '',
          '_4:': 'FR46ZZZ005002',
          creditor_name: 'DGFIP IMPOT',
          creditor_id: 'FR46ZZZ005002',
          creditor_id_type: '',
          mandate_identification: 'NN804148211DGFIP2019921505K41FN7QQ',
          sequence_type: '',
          end2end_identification: '220750510700113748308',
          purpose: '',
          remittance_information_1: 'TVA-032023-3310CA3',
        },
      ],
      problems: null,
    });
  });

  test('Known bank', () => {
    const text = [
      `0118020    00001EUR2 00410GXLT01  060423                                                  0000000012258N`,
      `0418020404100001EUR2 00410GXLT0121070423  050423VIREMENT BANCAIRE EN VOTRE FAVE  3175387 00000000594363K000070`,
      `0518020404100001EUR2 00410GXLT0121070423  050423URN 5335098    VIREMENT N 53350`,
      `0418020312600001EUR2 00410GXLT0167070423  050423TVA SUR PRECOMPTE DE COMM. DE F  3175387 00000000001429P000002`,
      `0518020312600001EUR2 00410GXLT0167070423  050423INANCEMENT   VIREMENT N 5335098`,
      `0418020302600001EUR2 00410GXLT0161070423  050423PRECOMPTE DE COMM. DE FINANCEME  3175387 00000000007148N000001`,
      `0518020302600001EUR2 00410GXLT0161070423  050423NT   VIREMENT N 5335098`,
      `0418020608100001EUR2 00410GXLT0191070423  070423PRELEVEMENT DE FG 10.00P SUR RE  3173891 00000000059253P000073`,
      `0518020608100001EUR2 00410GXLT0191070423  070423MISE N 2740649`,
      `0418020608300001EUR2 00410GXLT0191070423  070423PRELEVEMENT DE FONDS DE RESERVE  3173891 00000000023701N000017`,
      `0518020608300001EUR2 00410GXLT0191070423  070423 SUR REMISE N 2740649`,
      `0418020303100001EUR2 00410GXLT0167070423  070423TVA SUR COMMISSION D AFFACTURAG  3173891 00000000000273O000003`,
      `0518020303100001EUR2 00410GXLT0167070423  070423E SUR REMISE N 2740649`,
      `0418020302100001EUR2 00410GXLT0165070423  070423COMMISSION D AFFACTURAGE SUR RE  3173891 00000000001367R000002`,
      `0518020302100001EUR2 00410GXLT0165070423  070423MISE N 2740649`,
      `0418020100100001EUR2 00410GXLT0191070423  070423ACHAT REMISE DE FACTURES  REMIS  3173891 00000000911857G000001`,
      `0518020100100001EUR2 00410GXLT0191070423  070423E N 2740649`,
      `0418020312200001EUR2 00410GXLT0167070423  070423TVA SUR COMMISSION SUR REMISE D  3173163 00000000000063N000003`,
      `0518020312200001EUR2 00410GXLT0167070423  070423 AVOIRS   REMISE N 2740651`,
      `0418020302200001EUR2 00410GXLT0165070423  070423COMMISSION SUR REMISE D AVOIRS   3173163 00000000000317N000002`,
      `0518020302200001EUR2 00410GXLT0165070423  070423 REMISE N 2740651`,
      `0418020100200001EUR2 00410GXLT0191070423  070423ACHAT REMISE D AVOIRS  REMISE N  3173163 00000000211680J000001`,
      `0518020100200001EUR2 00410GXLT0191070423  070423 2740651`,
      `0718020    00001EUR2 00410GXLT01  070423                                                  0000000000000}`,
    ];

    expect(parse(text)).toEqual({
      header: {
        record_code: '01',
        bank_code: '18020',
        desk_code: '00001',
        currency_code: 'EUR',
        nb_of_dec: '2',
        account_nb: '00410GXLT01',
        prev_date: '2023-04-06',
        prev_amount: '-1225.85',
      },
      footer: {
        record_code: '07',
        bank_code: '18020',
        desk_code: '00001',
        currency_code: 'EUR',
        nb_of_dec: '2',
        account_nb: '00410GXLT01',
        next_date: '2023-04-07',
        next_amount: '0',
      },
      transactions: [
        {
          423: 'URN 5335098    VIREMENT N 53350',
          _1: '',
          _2: '050',
          _3: '0',
          '_4:': '000070',
          account_nb: '00410GXLT01',
          amount: '-59436.32',
          bank_code: '18020',
          currency_code: 'EUR',
          desk_code: '00001',
          exempt_code: '',
          internal_code: '4041',
          label: 'VIREMENT BANCAIRE EN VOTRE FAVE',
          nb_of_dec: '2',
          operation_code: '21',
          operation_date: '2023-04-07',
          record_code: '04',
          reference: '3175387',
          reject_code: '',
          value_date: '2023-04-05',
        },
        {
          423: 'INANCEMENT   VIREMENT N 5335098',
          _1: '',
          _2: '050',
          _3: '0',
          '_4:': '000002',
          account_nb: '00410GXLT01',
          amount: '-142.97',
          bank_code: '18020',
          currency_code: 'EUR',
          desk_code: '00001',
          exempt_code: '',
          internal_code: '3126',
          label: 'TVA SUR PRECOMPTE DE COMM. DE F',
          nb_of_dec: '2',
          operation_code: '67',
          operation_date: '2023-04-07',
          record_code: '04',
          reference: '3175387',
          reject_code: '',
          value_date: '2023-04-05',
        },
        {
          423: 'NT   VIREMENT N 5335098',
          _1: '',
          _2: '050',
          _3: '0',
          '_4:': '000001',
          account_nb: '00410GXLT01',
          amount: '-714.85',
          bank_code: '18020',
          currency_code: 'EUR',
          desk_code: '00001',
          exempt_code: '',
          internal_code: '3026',
          label: 'PRECOMPTE DE COMM. DE FINANCEME',
          nb_of_dec: '2',
          operation_code: '61',
          operation_date: '2023-04-07',
          record_code: '04',
          reference: '3175387',
          reject_code: '',
          value_date: '2023-04-05',
        },
        {
          423: 'MISE N 2740649',
          _1: '',
          _2: '070',
          _3: '0',
          '_4:': '000073',
          account_nb: '00410GXLT01',
          amount: '-5925.37',
          bank_code: '18020',
          currency_code: 'EUR',
          desk_code: '00001',
          exempt_code: '',
          internal_code: '6081',
          label: 'PRELEVEMENT DE FG 10.00P SUR RE',
          nb_of_dec: '2',
          operation_code: '91',
          operation_date: '2023-04-07',
          record_code: '04',
          reference: '3173891',
          reject_code: '',
          value_date: '2023-04-07',
        },
        {
          423: 'SUR REMISE N 2740649',
          _1: '',
          _2: '070',
          _3: '0',
          '_4:': '000017',
          account_nb: '00410GXLT01',
          amount: '-2370.15',
          bank_code: '18020',
          currency_code: 'EUR',
          desk_code: '00001',
          exempt_code: '',
          internal_code: '6083',
          label: 'PRELEVEMENT DE FONDS DE RESERVE',
          nb_of_dec: '2',
          operation_code: '91',
          operation_date: '2023-04-07',
          record_code: '04',
          reference: '3173891',
          reject_code: '',
          value_date: '2023-04-07',
        },
        {
          423: 'E SUR REMISE N 2740649',
          _1: '',
          _2: '070',
          _3: '0',
          '_4:': '000003',
          account_nb: '00410GXLT01',
          amount: '-27.36',
          bank_code: '18020',
          currency_code: 'EUR',
          desk_code: '00001',
          exempt_code: '',
          internal_code: '3031',
          label: 'TVA SUR COMMISSION D AFFACTURAG',
          nb_of_dec: '2',
          operation_code: '67',
          operation_date: '2023-04-07',
          record_code: '04',
          reference: '3173891',
          reject_code: '',
          value_date: '2023-04-07',
        },
        {
          423: 'MISE N 2740649',
          _1: '',
          _2: '070',
          _3: '0',
          '_4:': '000002',
          account_nb: '00410GXLT01',
          amount: '-136.79',
          bank_code: '18020',
          currency_code: 'EUR',
          desk_code: '00001',
          exempt_code: '',
          internal_code: '3021',
          label: 'COMMISSION D AFFACTURAGE SUR RE',
          nb_of_dec: '2',
          operation_code: '65',
          operation_date: '2023-04-07',
          record_code: '04',
          reference: '3173891',
          reject_code: '',
          value_date: '2023-04-07',
        },
        {
          423: 'E N 2740649',
          _1: '',
          _2: '070',
          _3: '0',
          '_4:': '000001',
          account_nb: '00410GXLT01',
          amount: '91185.77',
          bank_code: '18020',
          currency_code: 'EUR',
          desk_code: '00001',
          exempt_code: '',
          internal_code: '1001',
          label: 'ACHAT REMISE DE FACTURES  REMIS',
          nb_of_dec: '2',
          operation_code: '91',
          operation_date: '2023-04-07',
          record_code: '04',
          reference: '3173891',
          reject_code: '',
          value_date: '2023-04-07',
        },
        {
          423: 'AVOIRS   REMISE N 2740651',
          _1: '',
          _2: '070',
          _3: '0',
          '_4:': '000003',
          account_nb: '00410GXLT01',
          amount: '-6.35',
          bank_code: '18020',
          currency_code: 'EUR',
          desk_code: '00001',
          exempt_code: '',
          internal_code: '3122',
          label: 'TVA SUR COMMISSION SUR REMISE D',
          nb_of_dec: '2',
          operation_code: '67',
          operation_date: '2023-04-07',
          record_code: '04',
          reference: '3173163',
          reject_code: '',
          value_date: '2023-04-07',
        },
        {
          423: 'REMISE N 2740651',
          _1: '',
          _2: '070',
          _3: '0',
          '_4:': '000002',
          account_nb: '00410GXLT01',
          amount: '-31.75',
          bank_code: '18020',
          currency_code: 'EUR',
          desk_code: '00001',
          exempt_code: '',
          internal_code: '3022',
          label: 'COMMISSION SUR REMISE D AVOIRS',
          nb_of_dec: '2',
          operation_code: '65',
          operation_date: '2023-04-07',
          record_code: '04',
          reference: '3173163',
          reject_code: '',
          value_date: '2023-04-07',
        },
        {
          423: '2740651',
          _1: '',
          _2: '070',
          _3: '0',
          '_4:': '000001',
          account_nb: '00410GXLT01',
          amount: '-21168.01',
          bank_code: '18020',
          currency_code: 'EUR',
          desk_code: '00001',
          exempt_code: '',
          internal_code: '1002',
          label: 'ACHAT REMISE D AVOIRS  REMISE N',
          nb_of_dec: '2',
          operation_code: '91',
          operation_date: '2023-04-07',
          record_code: '04',
          reference: '3173163',
          reject_code: '',
          value_date: '2023-04-07',
        },
      ],
      problems: null,
    });
  });

  test('Known bank - with specific provider transactions', () => {
    const text = [
      '0118020    00001EUR2 00410GXLT11  050423                                                  0000024431270M                ',
      '0418020505100001EUR2 00410GXLT1105060423  310323VIREMENT RECU  FACTURE N 806500  3142953 00000000006000{000005          ',
      '0518020505100001EUR2 00410GXLT1105060423  31032341 LEROY MERLIN FRANCE                                                  ',
      '0418020505100001EUR2 00410GXLT1105060423  310323VIREMENT RECU  FACTURE N 806448  3142951 00000000012000{000005          ',
      '0518020505100001EUR2 00410GXLT1105060423  31032332 LEROY MERLIN FRANCE                                                  ',
      '0418020505100001EUR2 00410GXLT1105060423  310323VIREMENT RECU  FACTURE N 806471  3142949 00000000006000{000005          ',
      '0518020505100001EUR2 00410GXLT1105060423  31032340 LEROY MERLIN FRANCE                                                  ',
      '0418020505100001EUR2 00410GXLT1105060423  310323VIREMENT RECU  FACTURE N 806472  3142948 00000000006000{000005          ',
      '0518020505100001EUR2 00410GXLT1105060423  31032362 LEROY MERLIN FRANCE                                                  ',
      '0418020505100001EUR2 00410GXLT1105060423  310323VIREMENT RECU  FACTURE N 806473  3142947 00000000006000{000005          ',
      '0518020505100001EUR2 00410GXLT1105060423  31032301 LEROY MERLIN FRANCE                                                  ',
      '0718020    00001EUR2 00410GXLT11  060423                                                  0000024365270M                ',
    ];

    expect(parse(text)).toEqual({
      header: {
        record_code: '01',
        bank_code: '18020',
        desk_code: '00001',
        currency_code: 'EUR',
        nb_of_dec: '2',
        account_nb: '00410GXLT11',
        prev_date: '2023-04-05',
        prev_amount: '-2443127.04',
      },
      footer: {
        record_code: '07',
        bank_code: '18020',
        desk_code: '00001',
        currency_code: 'EUR',
        nb_of_dec: '2',
        account_nb: '00410GXLT11',
        next_date: '2023-04-06',
        next_amount: '-2436527.04',
      },
      problems: null,
      transactions: [
        {
          323: '41 LEROY MERLIN FRANCE',
          record_code: '04',
          bank_code: '18020',
          internal_code: '5051',
          desk_code: '00001',
          currency_code: 'EUR',
          nb_of_dec: '2',
          _1: '',
          account_nb: '00410GXLT11',
          operation_code: '05',
          operation_date: '2023-04-06',
          reject_code: '',
          value_date: '2023-03-31',
          label: 'VIREMENT RECU  FACTURE N 806500',
          _2: '310',
          reference: '3142953',
          exempt_code: '',
          _3: '0',
          amount: '600',
          '_4:': '000005',
        },
        {
          323: '32 LEROY MERLIN FRANCE',
          record_code: '04',
          bank_code: '18020',
          internal_code: '5051',
          desk_code: '00001',
          currency_code: 'EUR',
          nb_of_dec: '2',
          _1: '',
          account_nb: '00410GXLT11',
          operation_code: '05',
          operation_date: '2023-04-06',
          reject_code: '',
          value_date: '2023-03-31',
          label: 'VIREMENT RECU  FACTURE N 806448',
          _2: '310',
          reference: '3142951',
          exempt_code: '',
          _3: '0',
          amount: '1200',
          '_4:': '000005',
        },
        {
          323: '40 LEROY MERLIN FRANCE',
          record_code: '04',
          bank_code: '18020',
          internal_code: '5051',
          desk_code: '00001',
          currency_code: 'EUR',
          nb_of_dec: '2',
          _1: '',
          account_nb: '00410GXLT11',
          operation_code: '05',
          operation_date: '2023-04-06',
          reject_code: '',
          value_date: '2023-03-31',
          label: 'VIREMENT RECU  FACTURE N 806471',
          _2: '310',
          reference: '3142949',
          exempt_code: '',
          _3: '0',
          amount: '600',
          '_4:': '000005',
        },
        {
          323: '62 LEROY MERLIN FRANCE',
          record_code: '04',
          bank_code: '18020',
          internal_code: '5051',
          desk_code: '00001',
          currency_code: 'EUR',
          nb_of_dec: '2',
          _1: '',
          account_nb: '00410GXLT11',
          operation_code: '05',
          operation_date: '2023-04-06',
          reject_code: '',
          value_date: '2023-03-31',
          label: 'VIREMENT RECU  FACTURE N 806472',
          _2: '310',
          reference: '3142948',
          exempt_code: '',
          _3: '0',
          amount: '600',
          '_4:': '000005',
        },
        {
          323: '01 LEROY MERLIN FRANCE',
          record_code: '04',
          bank_code: '18020',
          internal_code: '5051',
          desk_code: '00001',
          currency_code: 'EUR',
          nb_of_dec: '2',
          _1: '',
          account_nb: '00410GXLT11',
          operation_code: '05',
          operation_date: '2023-04-06',
          reject_code: '',
          value_date: '2023-03-31',
          label: 'VIREMENT RECU  FACTURE N 806473',
          _2: '310',
          reference: '3142947',
          exempt_code: '',
          _3: '0',
          amount: '600',
          '_4:': '000005',
        },
      ],
    });
  });

  test('Known bank 2', () => {
    const text = [
      `0118020    00001EUR2 00410GXLT01  030323                                                  0000000773178H`,
      `0418020404100001EUR2 00410GXLT0121060323  040323VIREMENT BANCAIRE EN VOTRE FAVE  2059801 00000000771083K000070`,
      `0518020404100001EUR2 00410GXLT0121060323  040323URN 5295341    VIREMENT N 52953`,
      `0418020312600001EUR2 00410GXLT0167060323  040323TVA SUR PRECOMPTE DE COMM. DE F  2059801 00000000000349L000002`,
      `0518020312600001EUR2 00410GXLT0167060323  040323INANCEMENT   VIREMENT N 5295341`,
      `0418020302600001EUR2 00410GXLT0161060323  040323PRECOMPTE DE COMM. DE FINANCEME  2059801 00000000001746L000001`,
      `0518020302600001EUR2 00410GXLT0161060323  040323NT   VIREMENT N 5295341`,
      `0718020    00001EUR2 00410GXLT01  060323                                                  0000000000000}`,
    ];

    expect(parse(text)).toEqual({
      header: {
        record_code: '01',
        bank_code: '18020',
        desk_code: '00001',
        currency_code: 'EUR',
        nb_of_dec: '2',
        account_nb: '00410GXLT01',
        prev_date: '2023-03-03',
        prev_amount: '77317.88',
      },
      footer: {
        record_code: '07',
        bank_code: '18020',
        desk_code: '00001',
        currency_code: 'EUR',
        nb_of_dec: '2',
        account_nb: '00410GXLT01',
        next_date: '2023-03-06',
        next_amount: '0',
      },
      transactions: [
        {
          323: 'URN 5295341    VIREMENT N 52953',
          _1: '',
          _2: '040',
          _3: '0',
          '_4:': '000070',
          record_code: '04',
          bank_code: '18020',
          desk_code: '00001',
          currency_code: 'EUR',
          nb_of_dec: '2',
          account_nb: '00410GXLT01',
          operation_code: '21',
          operation_date: '2023-03-06',
          reject_code: '',
          value_date: '2023-03-04',
          label: 'VIREMENT BANCAIRE EN VOTRE FAVE',
          reference: '2059801',
          exempt_code: '',
          amount: '-77108.32',
          internal_code: '4041',
        },
        {
          323: 'INANCEMENT   VIREMENT N 5295341',
          _1: '',
          _2: '040',
          _3: '0',
          '_4:': '000002',
          account_nb: '00410GXLT01',
          amount: '-34.93',
          bank_code: '18020',
          currency_code: 'EUR',
          desk_code: '00001',
          exempt_code: '',
          internal_code: '3126',
          label: 'TVA SUR PRECOMPTE DE COMM. DE F',
          nb_of_dec: '2',
          operation_code: '67',
          operation_date: '2023-03-06',
          record_code: '04',
          reference: '2059801',
          reject_code: '',
          value_date: '2023-03-04',
        },
        {
          323: 'NT   VIREMENT N 5295341',
          _1: '',
          _2: '040',
          _3: '0',
          '_4:': '000001',
          account_nb: '00410GXLT01',
          amount: '-174.63',
          bank_code: '18020',
          currency_code: 'EUR',
          desk_code: '00001',
          exempt_code: '',
          internal_code: '3026',
          label: 'PRECOMPTE DE COMM. DE FINANCEME',
          nb_of_dec: '2',
          operation_code: '61',
          operation_date: '2023-03-06',
          record_code: '04',
          reference: '2059801',
          reject_code: '',
          value_date: '2023-03-04',
        },
      ],
      problems: null,
    });
  });

  test('Known bank 3 - no transactions', () => {
    const text = [
      `0118020    00001EUR2 00410GXLT01  210323                                                  0000000000000}`,
      `0718020    00001EUR2 00410GXLT01  220323                                                  0000000000000}`,
    ];

    expect(parse(text)).toEqual({
      header: {
        record_code: '01',
        bank_code: '18020',
        desk_code: '00001',
        currency_code: 'EUR',
        nb_of_dec: '2',
        account_nb: '00410GXLT01',
        prev_date: '2023-03-21',
        prev_amount: '0',
      },
      footer: {
        record_code: '07',
        bank_code: '18020',
        desk_code: '00001',
        currency_code: 'EUR',
        nb_of_dec: '2',
        account_nb: '00410GXLT01',
        next_date: '2023-03-22',
        next_amount: '0',
      },
      transactions: [],
      problems: null,
    });
  });

  test('Known bank 4 - no transactions', () => {
    const text = [
      `0118020    00001EUR2 00410GXLT11  210323                                                  0000019966371M`,
      `0718020    00001EUR2 00410GXLT11  220323                                                  0000019966371M                `,
    ];

    expect(parse(text)).toEqual({
      header: {
        record_code: '01',
        bank_code: '18020',
        desk_code: '00001',
        currency_code: 'EUR',
        nb_of_dec: '2',
        account_nb: '00410GXLT11',
        prev_date: '2023-03-21',
        prev_amount: '-1996637.14',
      },
      footer: {
        record_code: '07',
        bank_code: '18020',
        desk_code: '00001',
        currency_code: 'EUR',
        nb_of_dec: '2',
        account_nb: '00410GXLT11',
        next_date: '2023-03-22',
        next_amount: '-1996637.14',
      },
      transactions: [],
      problems: null,
    });
  });
});
